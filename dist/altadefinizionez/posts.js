var module={exports:exports},__getOwnPropNames=Object.getOwnPropertyNames,__commonJS=(cb,mod)=>function(){return mod||(0,cb[__getOwnPropNames(cb)[0]])((mod={exports:{}}).exports,mod),mod.exports},require_filters=__commonJS({"dist/altadefinizionez/filters.js"(exports2){"use strict";Object.defineProperty(exports2,"__esModule",{value:!0}),exports2.normalizeArchiveSorting=exports2.normalizeArchiveCountry=exports2.normalizeArchiveLanguage=exports2.normalizeArchiveRating=exports2.normalizeArchiveYear=exports2.normalizeArchiveGenre=exports2.normalizeArchiveType=exports2.ARCHIVE_SORT_OPTIONS=exports2.ARCHIVE_COUNTRY_OPTIONS=exports2.ARCHIVE_AUDIO_OPTIONS=exports2.ARCHIVE_RATING_MAX=exports2.ARCHIVE_RATING_MIN=exports2.ARCHIVE_YEAR_MAX_OFFSET=exports2.ARCHIVE_YEAR_MIN=exports2.ARCHIVE_GENRES=exports2.ARCHIVE_TYPE_OPTIONS=void 0;var DIACRITICS_REGEX=/[\u0300-\u036f]/g,normalizeKey=value=>value?value.trim().toLowerCase().normalize("NFD").replace(DIACRITICS_REGEX,"").replace(/[^a-z0-9]+/g,""):"";exports2.ARCHIVE_TYPE_OPTIONS=[{title:"TV Show",titleKey:"TV Show",value:"series",providerValue:"2"},{title:"Movie",titleKey:"Movie",value:"movie",providerValue:"1"}],exports2.ARCHIVE_GENRES=[{id:1,name:"Azione",title:"Action",titleKey:"Action"},{id:2,name:"Animazione",title:"Animation",titleKey:"Animation"},{id:3,name:"Avventura",title:"Adventure",titleKey:"Adventure"},{id:4,name:"Biografico",title:"Biography",titleKey:"Biography"},{id:5,name:"Commedia",title:"Comedy",titleKey:"Comedy"},{id:24,name:"Crime",title:"Crime",titleKey:"Crime"},{id:6,name:"Documentario",title:"Documentary",titleKey:"Documentary"},{id:7,name:"Drammatico",title:"Drama",titleKey:"Drama"},{id:8,name:"Erotico",title:"Erotic",titleKey:"Erotic"},{id:26,name:"Famiglia",title:"Family",titleKey:"Family"},{id:9,name:"Fantascienza",title:"Science Fiction",titleKey:"Science Fiction"},{id:10,name:"Fantasy",title:"Fantasy",titleKey:"Fantasy"},{id:11,name:"Giallo",title:"Mystery",titleKey:"Mystery"},{id:12,name:"Guerra",title:"War",titleKey:"War"},{id:13,name:"Horror",title:"Horror",titleKey:"Horror"},{id:14,name:"Musical",title:"Musical",titleKey:"Musical"},{id:15,name:"Poliziesco",title:"Police",titleKey:"Police"},{id:16,name:"Romantico",title:"Romance",titleKey:"Romance"},{id:23,name:"Storico",title:"Historical",titleKey:"Historical"},{id:17,name:"Spionaggio",title:"Spy",titleKey:"Spy"},{id:18,name:"Sportivo",title:"Sport",titleKey:"Sport"},{id:19,name:"Thriller",title:"Thriller",titleKey:"Thriller"},{id:20,name:"Western",title:"Western",titleKey:"Western"}],exports2.ARCHIVE_YEAR_MIN=1960,exports2.ARCHIVE_YEAR_MAX_OFFSET=0,exports2.ARCHIVE_RATING_MIN=1,exports2.ARCHIVE_RATING_MAX=10,exports2.ARCHIVE_AUDIO_OPTIONS=[{title:"Italian",titleKey:"Italian",value:"ita",providerValue:"ITA"},{title:"Original (SUB-ITA)",titleKey:"Original (SUB-ITA)",value:"sub-ita",providerValue:"Sub ITA"}],exports2.ARCHIVE_COUNTRY_OPTIONS=[{title:"Italy",titleKey:"Italy",value:"italy",providerValue:"Italia"},{title:"United States",titleKey:"United States",value:"usa",providerValue:"USA"},{title:"United Kingdom",titleKey:"United Kingdom",value:"uk",providerValue:"Regno Unito"},{title:"Spain",titleKey:"Spain",value:"spain",providerValue:"Spagna"},{title:"France",titleKey:"France",value:"france",providerValue:"Francia"},{title:"Germany",titleKey:"Germany",value:"germany",providerValue:"Germania"},{title:"Canada",titleKey:"Canada",value:"canada",providerValue:"Canada"},{title:"Japan",titleKey:"Japan",value:"japan",providerValue:"Giappone"},{title:"India",titleKey:"India",value:"india",providerValue:"India"},{title:"Australia",titleKey:"Australia",value:"australia",providerValue:"Australia"},{title:"Russia",titleKey:"Russia",value:"russia",providerValue:"Russia"},{title:"Belgium",titleKey:"Belgium",value:"belgium",providerValue:"Belgio"},{title:"Mexico",titleKey:"Mexico",value:"mexico",providerValue:"Messico"},{title:"Brazil",titleKey:"Brazil",value:"brazil",providerValue:"Brasile"},{title:"Poland",titleKey:"Poland",value:"poland",providerValue:"Polonia"},{title:"Norway",titleKey:"Norway",value:"norway",providerValue:"Norvegia"}],exports2.ARCHIVE_SORT_OPTIONS=[{title:"Date",titleKey:"Date",value:"date",providerValue:"date"},{title:"Rating",titleKey:"Rating",value:"rating",providerValue:"toprating"},{title:"Name - A-Z",titleKey:"Name - A-Z",value:"title",providerValue:"title"},{title:"Trending Movies",titleKey:"Trending Movies",value:"popfilm",providerValue:"popfilm"},{title:"Trending TV Series",titleKey:"Trending TV Series",value:"popserie",providerValue:"popserie"},{title:"Most Anticipated",titleKey:"Most Anticipated",value:"soon",providerValue:"soon"}];var ARCHIVE_TYPE_MAP={movie:"1",movies:"1",film:"1",films:"1",serie:"2",series:"2",tv:"2",tvshow:"2",tvshows:"2",tvseries:"2",show:"2",shows:"2"},GENRE_ID_SET=new Set(exports2.ARCHIVE_GENRES.map(genre=>genre.id)),GENRE_ID_BY_KEY=exports2.ARCHIVE_GENRES.reduce((acc,genre)=>(acc[normalizeKey(genre.name)]=genre.id,acc[normalizeKey(genre.title)]=genre.id,acc),{}),ARCHIVE_LANGUAGE_MAP={ita:"ITA",italian:"ITA",italiano:"ITA",subita:"Sub ITA",sub:"Sub ITA",subitaoriginal:"Sub ITA",original:"Sub ITA",originale:"Sub ITA",originalsubita:"Sub ITA",subitaoriginale:"Sub ITA"},ARCHIVE_COUNTRY_MAP=exports2.ARCHIVE_COUNTRY_OPTIONS.reduce((acc,country)=>(acc[normalizeKey(country.title)]=country.providerValue,acc[normalizeKey(country.providerValue)]=country.providerValue,acc[normalizeKey(country.value)]=country.providerValue,acc),{});ARCHIVE_COUNTRY_MAP.unitedstatesofamerica="USA",ARCHIVE_COUNTRY_MAP.unitedstates="USA",ARCHIVE_COUNTRY_MAP.us="USA",ARCHIVE_COUNTRY_MAP.u="USA",ARCHIVE_COUNTRY_MAP.uk="Regno Unito",ARCHIVE_COUNTRY_MAP.england="Regno Unito",ARCHIVE_COUNTRY_MAP.britain="Regno Unito",ARCHIVE_COUNTRY_MAP.greatbritain="Regno Unito";var ARCHIVE_SORT_MAP={date:"date",data:"date",latest:"date",newest:"date",recent:"date",toprating:"toprating",rating:"toprating",score:"toprating",valutazione:"toprating",title:"title",name:"title",nome:"title",az:"title",a:"title",nomeaz:"title",nameaz:"title",popfilm:"popfilm",trendingmovies:"popfilm",popularmovies:"popfilm",popserie:"popserie",trendingseries:"popserie",trendingtvseries:"popserie",popularseries:"popserie",soon:"soon",upcoming:"soon",mostanticipated:"soon",piuattesi:"soon"},normalizeMappedValue=(value,mapping)=>{if(!value)return;const normalized=normalizeKey(value);return normalized?mapping[normalized]||value.trim():void 0};exports2.normalizeArchiveType=value=>{if(!value)return;const trimmed=value.trim();if("1"===trimmed||"2"===trimmed)return trimmed;const normalized=normalizeKey(trimmed);return ARCHIVE_TYPE_MAP[normalized]};exports2.normalizeArchiveGenre=value=>{if(!value)return;const trimmed=value.trim();if(!trimmed)return;const parsed=Number.parseInt(trimmed,10);if(Number.isFinite(parsed)&&GENRE_ID_SET.has(parsed))return String(parsed);const normalized=normalizeKey(trimmed),resolved=GENRE_ID_BY_KEY[normalized];return resolved?String(resolved):void 0};exports2.normalizeArchiveYear=value=>{if(!value)return;const parsed=Number.parseInt(value.trim(),10);if(!Number.isFinite(parsed))return;const maxYear=(new Date).getFullYear()+exports2.ARCHIVE_YEAR_MAX_OFFSET;return parsed<exports2.ARCHIVE_YEAR_MIN||parsed>maxYear?void 0:String(parsed)};exports2.normalizeArchiveRating=value=>{if(!value)return;const parsed=Number.parseInt(value.trim(),10);return Number.isFinite(parsed)&&!(parsed<exports2.ARCHIVE_RATING_MIN||parsed>exports2.ARCHIVE_RATING_MAX)?String(parsed):void 0};exports2.normalizeArchiveLanguage=value=>{if(!value)return;const trimmed=value.trim();return"ITA"===trimmed||"Sub ITA"===trimmed?trimmed:normalizeMappedValue(trimmed,ARCHIVE_LANGUAGE_MAP)};exports2.normalizeArchiveCountry=value=>{if(value)return normalizeMappedValue(value,ARCHIVE_COUNTRY_MAP)};exports2.normalizeArchiveSorting=value=>{if(!value)return;const trimmed=value.trim();return"date"===trimmed||"toprating"===trimmed||"title"===trimmed||"popfilm"===trimmed||"popserie"===trimmed||"soon"===trimmed?trimmed:normalizeMappedValue(trimmed,ARCHIVE_SORT_MAP)}}}),__awaiter=exports&&exports.__awaiter||function(thisArg,_arguments,P,generator){return new(P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){var value;result.done?resolve(result.value):(value=result.value,value instanceof P?value:new P(function(resolve){resolve(value)})).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})};Object.defineProperty(exports,"__esModule",{value:!0}),exports.getSearchPosts=exports.getPosts=void 0;var filters_1=require_filters(),DEFAULT_BASE_URL="https://altadefinizionez.sbs",REQUEST_TIMEOUT=1e4,normalizeBaseUrl=value=>value.replace(/\/+$/,""),HERO_RANDOM_FLAG="random",resolveBaseUrl=providerContext=>__awaiter(void 0,void 0,void 0,function*(){try{const resolved=yield providerContext.getBaseUrl("altadefinizionez");if(resolved)return normalizeBaseUrl(resolved)}catch(_){}return DEFAULT_BASE_URL}),resolveUrl=(href,baseUrl)=>href?/^https?:\/\//i.test(href)?href:new URL(href,baseUrl).href:"",stripHash=href=>href.split("#")[0],parseBooleanFlag=value=>"1"===value||"true"===value||"yes"===value,parseFilterRandom=rawFilter=>{const trimmed=(rawFilter||"").trim(),queryIndex=trimmed.indexOf("?");if(-1===queryIndex)return{filter:trimmed,random:!1};const path=trimmed.slice(0,queryIndex),rawQuery=trimmed.slice(queryIndex+1);if(!rawQuery)return{filter:trimmed,random:!1};const kept=[];let random=!1;rawQuery.split("&").map(part=>part.trim()).filter(Boolean).forEach(part=>{const[rawKey,rawValue=""]=part.split("="),key=decodeURIComponent(rawKey||"").toLowerCase(),value=decodeURIComponent(rawValue||"");key===HERO_RANDOM_FLAG?random=parseBooleanFlag(value):rawKey&&kept.push(part)});return{filter:kept.length>0?`${path}?${kept.join("&")}`:path,random:random}},decodeParam=value=>{if(!value)return"";try{return decodeURIComponent(value.replace(/\+/g," "))}catch(_){return value}},parseQueryParams=rawQuery=>{const map=new Map;return(rawQuery||"").split("&").map(part=>part.trim()).filter(Boolean).forEach(part=>{const[rawKey,rawValue=""]=part.split("=");if(!rawKey)return;const key=decodeParam(rawKey).trim().toLowerCase();if(!key)return;const value=decodeParam(rawValue),existing=map.get(key)||[];existing.push(value),map.set(key,existing)}),{get:key=>{const values=map.get(key.toLowerCase());return values&&values.length>0?values[0]:null},getAll:key=>{const values=map.get(key.toLowerCase());return values?[...values]:[]},entries:()=>Array.from(map.entries()),has:key=>map.has(key.toLowerCase()),size:map.size}},parseFilterParams=filter=>{const queryIndex=filter.indexOf("?"),path=queryIndex>=0?filter.slice(0,queryIndex):filter,rawQuery=queryIndex>=0?filter.slice(queryIndex+1):"";return{path:path,params:parseQueryParams(rawQuery)}},isArchiveFilter=filter=>{const[path]=(filter||"").split("?");return"catalog/all"===path.replace(/^\/+/,"").replace(/\/+$/,"").toLowerCase()},ARCHIVE_PARAM_KEYS=new Set(["tipo","type","category","content","media","genere","genre","genres","years","year","anno","rating","score","valutazione","language","audio","lang","country","paese","nation","sorting","sort","order"]),splitMultiValues=value=>value.split(",").map(item=>item.trim()).filter(Boolean),normalizeArchiveFilter=filter=>{if(!isArchiveFilter(filter))return filter;const parsed=parseFilterParams(filter);if(0===parsed.params.size)return filter;const pairs=[],addPair=(key,value)=>{key&&pairs.push(`${key}=${encodeURIComponent(value)}`)},typeValue=parsed.params.get("tipo")||parsed.params.get("type")||parsed.params.get("category")||parsed.params.get("content")||parsed.params.get("media"),normalizedType=(0,filters_1.normalizeArchiveType)(typeValue);normalizedType&&addPair("tipo",normalizedType);const rawGenres=[...parsed.params.getAll("genere"),...parsed.params.getAll("genre"),...parsed.params.getAll("genres")],normalizedGenres=new Set;rawGenres.forEach(raw=>{splitMultiValues(raw).forEach(value=>{const normalized=(0,filters_1.normalizeArchiveGenre)(value);normalized&&normalizedGenres.add(normalized)})}),normalizedGenres.forEach(genreId=>{addPair("genere",genreId)});const yearValue=parsed.params.get("years")||parsed.params.get("year")||parsed.params.get("anno"),normalizedYear=(0,filters_1.normalizeArchiveYear)(yearValue);normalizedYear&&addPair("years",normalizedYear);const ratingValue=parsed.params.get("rating")||parsed.params.get("score")||parsed.params.get("valutazione"),normalizedRating=(0,filters_1.normalizeArchiveRating)(ratingValue);normalizedRating&&addPair("rating",normalizedRating);const languageValue=parsed.params.get("language")||parsed.params.get("audio")||parsed.params.get("lang"),normalizedLanguage=(0,filters_1.normalizeArchiveLanguage)(languageValue);normalizedLanguage&&addPair("language",normalizedLanguage);const countryValue=parsed.params.get("country")||parsed.params.get("paese")||parsed.params.get("nation"),normalizedCountry=(0,filters_1.normalizeArchiveCountry)(countryValue);normalizedCountry&&addPair("country",normalizedCountry);const sortingValue=parsed.params.get("sorting")||parsed.params.get("sort")||parsed.params.get("order"),normalizedSorting=(0,filters_1.normalizeArchiveSorting)(sortingValue);normalizedSorting&&addPair("sorting",normalizedSorting),parsed.params.entries().forEach(([key,values])=>{ARCHIVE_PARAM_KEYS.has(key)||values.forEach(value=>{key&&(value?pairs.push(`${encodeURIComponent(key)}=${encodeURIComponent(value)}`):pairs.push(encodeURIComponent(key)))})});const query=pairs.join("&");return query?`${parsed.path}?${query}`:parsed.path},isDetailLink=(href,baseUrl)=>{if(!href)return!1;try{const resolved=new URL(href,baseUrl),baseHost=new URL(baseUrl).hostname;return!!resolved.hostname.endsWith(baseHost)&&/\/\d+[^/]*\.html\/?$/i.test(resolved.pathname)}catch(_){return!1}},buildListUrl=(baseUrl,filter,page)=>{const normalized=(filter||"").trim(),safePage=page>1?page:1;if(!normalized||"latest"===normalized)return`${baseUrl}/`;if(/^https?:\/\//i.test(normalized))return normalized;const[pathPart,queryPart]=normalized.split("?"),cleanedPath=(pathPart||"").replace(/^\/+/,"").replace(/\/+$/,"");return cleanedPath?"film"===cleanedPath?safePage>1?`${baseUrl}/film/page/${safePage}/${queryPart?`?${queryPart}`:""}`:`${baseUrl}/film/${queryPart?`?${queryPart}`:""}`:cleanedPath.startsWith("catalog/")?safePage>1?`${baseUrl}/${cleanedPath}/page/${safePage}/${queryPart?`?${queryPart}`:""}`:`${baseUrl}/${cleanedPath}/${queryPart?`?${queryPart}`:""}`:safePage>1?`${baseUrl}/${cleanedPath}/page/${safePage}/`:queryPart?`${baseUrl}/${cleanedPath}/?${queryPart}`:`${baseUrl}/${cleanedPath}/`:`${baseUrl}/`},extractImage=(element,baseUrl)=>{const img=element.find("img").first(),src=img.attr("data-src")||img.attr("data-lazy-src")||img.attr("data-original")||img.attr("src")||"";return src?resolveUrl(src,baseUrl):""},addPost=(posts,seen,post)=>{post.title&&post.link&&post.image&&(seen.has(post.link)||(posts.push(post),seen.add(post.link)))},parseGridPosts=($,baseUrl,posts,seen)=>{$(".movie").each((_index,element)=>{const item=$(element),anchor=item.find(".movie-poster a[href]").first(),href=anchor.attr("href")||"",resolved=stripHash(resolveUrl(href,baseUrl));if(!isDetailLink(resolved,baseUrl))return;const title=item.find(".movie-title a").first().text().trim()||anchor.attr("title")||anchor.text().trim(),image=extractImage(item.find(".movie-poster").first(),baseUrl),episodeLabelText=item.find(".movie-label .label.episode").first().text().trim()||"",isSeasonEpisodeLabel=/^\d+\s*x\s*\d+$/i.test(episodeLabelText),episodeLabelKey=episodeLabelText&&!isSeasonEpisodeLabel?"EP {{number}}":void 0;addPost(posts,seen,{title:title,link:resolved,image:image,episodeLabel:episodeLabelText||void 0,episodeLabelKey:episodeLabelKey,episodeLabelParams:episodeLabelKey?{number:episodeLabelText}:void 0})})},parseTablePosts=($,baseUrl,posts,seen)=>{$("table.catalog-table tr").each((_index,element)=>{const row=$(element),anchor=row.find("a[href]").first(),href=anchor.attr("href")||"",resolved=stripHash(resolveUrl(href,baseUrl));if(!isDetailLink(resolved,baseUrl))return;const title=row.find("h2 a").first().text().trim()||anchor.attr("title")||anchor.text().trim(),image=extractImage(row,baseUrl);addPost(posts,seen,{title:title,link:resolved,image:image})})},parseTrendingPosts=($,baseUrl,posts,seen)=>{const container=$("#trending").first();container.length&&container.find(".swiper-slide").each((_index,element)=>{const item=$(element),anchor=item.find("a[href]").first(),href=anchor.attr("href")||"",resolved=stripHash(resolveUrl(href,baseUrl));if(!isDetailLink(resolved,baseUrl))return;const title=anchor.attr("title")||anchor.text().trim()||item.find(".movie-title a").first().text().trim(),image=extractImage(item.find(".movie-poster").first(),baseUrl);addPost(posts,seen,{title:title,link:resolved,image:image})})},parseFallbackPosts=($,baseUrl,posts,seen)=>{$(".movie-poster a[href]").each((_index,element)=>{const anchor=$(element),href=anchor.attr("href")||"",resolved=stripHash(resolveUrl(href,baseUrl));if(!isDetailLink(resolved,baseUrl))return;const title=anchor.attr("title")||anchor.text().trim(),image=extractImage(anchor,baseUrl);addPost(posts,seen,{title:title,link:resolved,image:image})})},parsePostsFromHtml=(html,baseUrl,cheerio)=>{const $=cheerio.load(html||""),posts=[],seen=new Set;return parseGridPosts($,baseUrl,posts,seen),parseTablePosts($,baseUrl,posts,seen),0===posts.length&&parseFallbackPosts($,baseUrl,posts,seen),posts},fetchTrendingPosts=_a=>__awaiter(void 0,[_a],void 0,function*({baseUrl:baseUrl,providerContext:providerContext,signal:signal}){var _b;const{axios:axios,commonHeaders:commonHeaders,cheerio:cheerio}=providerContext,res=yield axios.get(baseUrl,{headers:Object.assign(Object.assign({},commonHeaders),{Referer:`${baseUrl}/`}),timeout:REQUEST_TIMEOUT,signal:signal}),html="string"==typeof res.data?res.data:String(null!==(_b=res.data)&&void 0!==_b?_b:""),$=cheerio.load(html||""),posts=[];return parseTrendingPosts($,baseUrl,posts,new Set),posts}),isTrendingFilter=filter=>"trending"===(filter||"").trim().toLowerCase(),extractMaxPageFromHtml=(html,cheerio)=>{const $=cheerio.load(html||""),pageNumbers=$('a[href*="/page/"]').map((_index,element)=>{const match=($(element).attr("href")||"").match(/\/page\/(\d+)/i);return match?Number.parseInt(match[1],10):null}).get().filter(value=>Number.isFinite(value));if(0===pageNumbers.length)return 1;const maxPage=Math.max(...pageNumbers);return Number.isFinite(maxPage)&&maxPage>0?maxPage:1},fetchPostsPage=_a=>__awaiter(void 0,[_a],void 0,function*({baseUrl:baseUrl,filter:filter,page:page,providerContext:providerContext,signal:signal}){var _b;const{axios:axios,commonHeaders:commonHeaders,cheerio:cheerio}=providerContext,url=buildListUrl(baseUrl,filter,page),res=yield axios.get(url,{headers:Object.assign(Object.assign({},commonHeaders),{Referer:`${baseUrl}/`}),timeout:REQUEST_TIMEOUT,signal:signal}),html="string"==typeof res.data?res.data:String(null!==(_b=res.data)&&void 0!==_b?_b:"");return{posts:parsePostsFromHtml(html,baseUrl,cheerio),html:html}}),fetchRandomArchivePosts=_a=>__awaiter(void 0,[_a],void 0,function*({baseUrl:baseUrl,filter:filter,providerContext:providerContext,signal:signal}){const{cheerio:cheerio}=providerContext,firstPage=yield fetchPostsPage({baseUrl:baseUrl,filter:filter,page:1,providerContext:providerContext,signal:signal}),maxPage=extractMaxPageFromHtml(firstPage.html,cheerio);if(maxPage<=1)return firstPage.posts;const randomPage=1+Math.floor(Math.random()*maxPage);if(1===randomPage)return firstPage.posts;const randomPageData=yield fetchPostsPage({baseUrl:baseUrl,filter:filter,page:randomPage,providerContext:providerContext,signal:signal});return randomPageData.posts.length>0?randomPageData.posts:firstPage.posts}),getPosts=function(_a){return __awaiter(this,arguments,void 0,function*({filter:filter,page:page,signal:signal,providerContext:providerContext}){try{if(null==signal?void 0:signal.aborted)return[];const baseUrl=yield resolveBaseUrl(providerContext),parsedFilter=parseFilterRandom(filter),normalizedFilter=normalizeArchiveFilter(parsedFilter.filter);if(isTrendingFilter(parsedFilter.filter))return yield fetchTrendingPosts({baseUrl:baseUrl,providerContext:providerContext,signal:signal});if(parsedFilter.random&&isArchiveFilter(normalizedFilter))return yield fetchRandomArchivePosts({baseUrl:baseUrl,filter:normalizedFilter,providerContext:providerContext,signal:signal});return(yield fetchPostsPage({baseUrl:baseUrl,filter:normalizedFilter,page:page,providerContext:providerContext,signal:signal})).posts}catch(err){return[]}})};exports.getPosts=getPosts;var getSearchPosts=function(_a){return __awaiter(this,arguments,void 0,function*({searchQuery:searchQuery,page:page,signal:signal,providerContext:providerContext}){var _b;try{if(null==signal?void 0:signal.aborted)return[];const normalized=(searchQuery||"").trim();if(!normalized)return[];if(page>1)return[];const{axios:axios,commonHeaders:commonHeaders,cheerio:cheerio}=providerContext,baseUrl=yield resolveBaseUrl(providerContext),body=`do=search&subaction=search&story=${encodeURIComponent(normalized)}`,res=yield axios.post(`${baseUrl}/`,body,{headers:Object.assign(Object.assign({},commonHeaders),{Referer:`${baseUrl}/`,"Content-Type":"application/x-www-form-urlencoded"}),timeout:REQUEST_TIMEOUT,signal:signal});return parsePostsFromHtml("string"==typeof res.data?res.data:String(null!==(_b=res.data)&&void 0!==_b?_b:""),baseUrl,cheerio)}catch(err){return[]}})};exports.getSearchPosts=getSearchPosts;